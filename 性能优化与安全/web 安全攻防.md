### 一、XSS

XSS (Cross-Site Scripting)，**跨站脚本攻击**

跨站脚本攻击是指通过存在安全漏洞的 Web 网站注册用户的浏览器内运行非法的 HTML 标签或 JavaScript 进行的一种攻击

跨站脚本攻击有可能造成以下影响:

- 利用虚假输入表单骗取用户个人信息。
- 利用脚本窃取用户的 Cookie 值，被害者在不知情的情况下，帮助攻击者发送恶意请求。
- 显示伪造的文章或图片。

**XSS 的原理是恶意攻击者往 Web 页面里插入恶意可执行网页脚本代码，当用户浏览该页之时，嵌入其中 Web 里面的脚本代码会被执行，从而可以达到攻击者盗取用户信息或其他侵犯用户安全隐私的目的**

#### 1、非持久型 XSS（反射型 XSS ）

> 非持久型 XSS 漏洞，一般是通过给别人发送**带有恶意脚本代码参数的 URL**，当 URL 地址被打开时，特有的恶意代码参数被 HTML 解析、执行

一些浏览器如 Chrome 其内置了一些 XSS 过滤器，可以防止大部分反射型 XSS 攻击

**非持久型 XSS 漏洞攻击有以下几点特征**：

- 即时性，不经过服务器存储，直接通过 HTTP 的 GET 和 POST 请求就能完成一次攻击，拿到用户隐私数据。
- 攻击者需要诱骗点击，必须要通过用户点击链接才能发起
- 反馈率低，所以较难发现和响应修复
- 盗取用户敏感保密信息

**为了防止出现非持久型 XSS 漏洞，需要确保这么几件事情**：

- Web 页面渲染的所有内容或者渲染的数据都必须来自于服务端。
- 尽量不要从 `URL`，`document.referrer`，`document.forms` 等这种 DOM API 中获取数据直接渲染。
- 尽量不要使用 `eval`,  `new Function()`，`document.write()`，`document.writeln()`，`window.setInterval()`，`window.setTimeout()`，`innerHTML`，`document.createElement()` 等可执行字符串的方法。
- 如果做不到以上几点，也必须对涉及 DOM 渲染的方法传入的字符串参数做 escape 转义。
- 前端渲染的时候对任何的字段都需要做 escape 转义编码。

#### 2、持久型 XSS（存储型 XSS）

> 持久型 XSS 漏洞，一般存在于 Form 表单提交等交互功能，如文章留言，提交文本信息等，黑客利用的 XSS 漏洞，将内容经正常功能提交进入数据库持久保存，当前端页面获得后端从数据库中读出的注入代码时，恰好将其渲染执行

**持久型 XSS 有以下几个特点**：

- 持久性，植入在数据库中
- 盗取用户敏感私密信息
- 危害面广

#### 3、如何防御

##### 3.1、CSP

CSP 本质上就是建立白名单，开发者明确告诉浏览器哪些外部资源可以加载和执行。只需要配置规则，如何拦截是由浏览器自己实现的。可以通过这种方式来尽量减少 XSS 攻击。

通常可以通过两种方式来开启 CSP：

1. 设置 HTTP Header 中的 Content-Security-Policy

2. 设置 meta 标签的方式

这里以设置 HTTP Header 来举例：

- 只允许加载本站资源

```js
Content-Security-Policy: default-src 'self'
```

- 只允许加载 HTTPS 协议图片

```js
Content-Security-Policy: img-src https://*
```

- 允许加载任何来源框架

```js
Content-Security-Policy: child-src 'none'
```

##### 3.2、转义字符

> 户的输入永远不可信任的，最普遍的做法就是转义输入输出的内容，对于引号、尖括号、斜杠进行转义

##### 3.3、HttpOnly Cookie

> 这是预防 XSS 攻击窃取用户 cookie 最有效的防御手段。Web 应用程序在设置 cookie 时，将其属性设为 HttpOnly，就可以避免该网页的 cookie 被客户端恶意 JavaScript 窃取，保护用户 cookie 信息

### 二、CSRF

CSRF(Cross Site Request Forgery)，即**跨站请求伪造**，是一种常见的 Web 攻击，它利用用户已登录的身份，在用户毫不知情的情况下，以用户的名义完成非法操作

#### 1、CSRF 攻击的原理

完成 CSRF 攻击必须要有三个条件：

- 用户已经登录了站点 A，并在本地记录了 cookie
- 在用户没有登出站点 A 的情况下（也就是 cookie 生效的情况下），访问了恶意攻击者提供的引诱危险站点 B (B 站点要求访问站点 A)。
- 站点 A 没有做任何 CSRF 防御

#### 2、如何防御

防范 CSRF 攻击可以遵循以下几种规则：

- Get 请求不对数据进行修改
- 不让第三方网站访问到用户 Cookie
- 阻止第三方网站请求接口
- 请求时附带验证信息，比如验证码或者 Token

##### 2.1、SameSite

> 可以对 Cookie 设置 SameSite 属性。该属性表示 Cookie 不随着跨域请求发送，可以很大程度减少 CSRF 的攻击，但是该属性目前并不是所有浏览器都兼容

##### 2.2、Referer Check

> HTTP Referer 是 header 的一部分，当浏览器向 web 服务器发送请求时，**通过检查 http header referer 的值是不是这个页面，来判断是不是 CSRF 攻击**

##### 2.3、Anti CSRF Token

> 目前比较完善的解决方案是加入 Anti-CSRF-Token。即发送请求时在 HTTP 请求中以参数的形式加入一个随机产生的 token，并在服务器建立一个拦截器来验证这个 token

##### 2.4、验证码



### 三、**点击劫持**

> 点击劫持是一种视觉欺骗的攻击手段。攻击者将需要攻击的网站通过 iframe 嵌套的方式嵌入自己的网页中，并将 iframe 设置为透明，在页面中透出一个按钮诱导用户点击



### 四、URL跳转漏洞

> 借助未验证的 URL 跳转，将应用程序引导到不安全的第三方区域，从而导致的安全问题。



### 五、SQL注入

> SQL 注入是针对数据库的。SQL 注入是一种常见的 Web 安全漏洞，攻击者利用这个漏洞，可以访问或修改数据，或者利用潜在的**数据库漏洞**进行攻击



### 六、OS命令注入攻击

> OS 命令注入是针对操作系统的。OS命令注入攻击指通过 Web 应用，执行非法的操作系统命令达到攻击的目的